
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A primer on data-driven dimension reduction &#8212; equadratures</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/styles.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/footer.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/cards.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    <link rel="shortcut icon" href="../../_static/eq-logo-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Data-driven dimension reduction in turbomachinery" href="Dimension_Reduction_Turbomachinery.html" />
    <link rel="prev" title="Sensitivity analysis for a piston model" href="../tutorial_6.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/logo_new.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="ml-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../tutorials.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../documentation.html">
  Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../research.html">
  Research
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../apps.html">
  Apps
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../developers.html">
  Developers
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://discourse.equadratures.org/">Discourse<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search equadratures..." aria-label="Search equadratures..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p class="caption">
 <span class="caption-text">
  Foundations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_Defining_a_Parameter.html">
   Foundations I: Parameter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_Orthogonal_Polynomials.html">
   Foundations II: Orthogonal polynomials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_Model_Fitting.html">
   Foundations III: Solving linear systems for model fitting
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Uncertainty quantification and sensitivity analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Computing_Moments_for_CFD.html">
   Uncertainty quantification of CFD simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorial_5.html">
   Uncertainty quantification with correlations for a borehole model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorial_6.html">
   Sensitivity analysis for a piston model
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Dimension reduction
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   A primer on data-driven dimension reduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Dimension_Reduction_Turbomachinery.html">
   Data-driven dimension reduction in turbomachinery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorial_8.html">
   Adjoint/gradient-enhanced surrogate modelling
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Optimisation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorial_9.html">
   Surrogate-based design optimisation on Rosenbrock’s function
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Advanced applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorial_10.html">
   Machine learning California housing with interpretable polynomial trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorial_11.html">
   Time-series remaining useful life prediction with spatio-temporal polynomials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorial_12.html">
   Flow-field estimation using vector-valued polynomial ridge approximations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorial_13.html">
   Multi-fidelity Bayesian polynomials on turbine cascade experiments
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Dimension-reduction-for-a-fan-blade">
   Dimension reduction for a fan blade
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="A-primer-on-data-driven-dimension-reduction">
<h1>A primer on data-driven dimension reduction<a class="headerlink" href="#A-primer-on-data-driven-dimension-reduction" title="Permalink to this headline">¶</a></h1>
<p>Many physical systems are high dimensional, which can make it challenging to obtain approximations of them, and it often even more challenging to visualise these approximations. However, all is not lost! Many seemingly high-dimensional systems have intrinsically low-dimensional structure. Although the quantity of interest <span class="math notranslate nohighlight">\(f(\mathbf{x})\)</span> might be defined as a function of a large set of parameters <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^d\)</span>, its variation can often be approximately captured with a
small number of linear projections of the original parameters <span class="math notranslate nohighlight">\(\mathbf{W}^T \mathbf{x} \in \mathbb{R}^n\)</span>. Here, <span class="math notranslate nohighlight">\(n \ll d\)</span> and <span class="math notranslate nohighlight">\(\mathbf{W} \in \mathbb{R}^{d\times n}\)</span> is a tall matrix whose column span is called the <em>dimension reducing subspace</em>, or <em>active subspace</em>.</p>
<p>In other words, we assume that our quantities of interest are well–approximated by <em>ridge functions</em>,</p>
<div class="math notranslate nohighlight">
\[f(\mathbf{x}) \approx g(\mathbf{W}^T \mathbf{x}),\]</div>
<p>where <span class="math notranslate nohighlight">\(g:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> is a low-dimensional non-linear function called the <em>ridge profile</em>. The intuitive computational advantage behind <em>ridge approximations</em> is that instead of estimating a function in <span class="math notranslate nohighlight">\(\mathbb{R}^d\)</span>, we approximate it in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, which also facilitates easy visualisation. In figure b) below, a ridge approximation is obtained for a turbo-machinery dataset [1], demonstrating how a low dimensional approximation can be obtained with
a suitable <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> matrix.</p>
<p>The <em>equadratures</em> code uses orthogonal polynomials to represent <span class="math notranslate nohighlight">\(g\)</span>, and so identifying ridge functions consists of computing coefficients for <span class="math notranslate nohighlight">\(g\)</span> as well as identifying a suitable subspace matrix <span class="math notranslate nohighlight">\(\mathbf{W}\)</span>. Two techniques are avaiable for this in the code, <em>active subspaces</em> and <em>variable projection</em>.</p>
<div class="section" id="Dimension-reduction-for-a-fan-blade">
<h2>Dimension reduction for a fan blade<a class="headerlink" href="#Dimension-reduction-for-a-fan-blade" title="Permalink to this headline">¶</a></h2>
<p>To provide a brief demononstration, we take a dataset from this <a class="reference external" href="https://doi.org/10.1115/1.4038839">Journal of Turbomachinery paper</a>. A turbomachinery fan blade is parameterised by <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{25}\)</span>, and the Quantity of Interest (QoI) is the efficiency <span class="math notranslate nohighlight">\(\eta=f(\mathbf{x})\)</span> of the fan blade. The task here is to find a subspace matrix <span class="math notranslate nohighlight">\(\mathbf{W} \in \mathbb{R}^{25\times 1}\)</span>, so that the <span class="math notranslate nohighlight">\(f(\mathbf{x})\)</span> can be approximated over a dimension reducing
subspace <span class="math notranslate nohighlight">\(u=\mathbf{W}^T \mathbf{x}\)</span>, where <span class="math notranslate nohighlight">\(u \in \mathbb{R}^1\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_eq_dataset</span><span class="p">(</span><span class="s1">&#39;3Dfan_blades&#39;</span><span class="p">)</span>
<span class="n">X</span>  <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;X_a&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y1_a&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading the 3Dfan_blades dataset from github...

 This dataset contains aerodynamic data for three Rolls-Royce research fan blades. This data is shared with permission from Rolls-Royce plc. For blade there is a design of experiment with inputs, which denote the 3D design parameters, and outputs, which correspond to the non-dimensional pressure ratio and non-dimensional efficiency values.

Data in file:

`X_a`:  A numpy ndarray with shape (548, 25), containing the 3D design parameters for each variant of a baseline Blade A.

`y1_a`: A numpy ndarray with shape (548,1), containing non-dimensional efficiency for each variant of a baseline Blade A.

`y2_a`: A numpy ndarray with shape (548,1), containing non-dimensional pressure ratio for each variant of a baseline Blade A.

`X_b`:  A numpy ndarray with shape (311, 25), containing the 3D design parameters for each variant of a baseline Blade B.

`y1_b`: A numpy ndarray with shape (311,1), containing non-dimensional efficiency for each variant of a baseline Blade B.

`y2_b`: A numpy ndarray with shape (311,1), containing non-dimensional pressure ratio for each variant of a baseline Blade B.

`X_c`:  A numpy ndarray with shape (547, 25), containing the 3D design parameters for each variant of a baseline Blade C.

`y1_c`: A numpy ndarray with shape (547,1), containing non-dimensional efficiency for each variant of a baseline Blade C.

`y2_c`: A numpy ndarray with shape (547,1), containing non-dimensional pressure ratio for each variant of a baseline Blade C.

</pre></div></div>
</div>
<p>Before using equadratures, lets see what happens when the subspace is formed from an equal contribution of all 25 design parameters, by setting <span class="math notranslate nohighlight">\(\mathbf{W} = \frac{\mathbf{1}}{\sqrt{25}}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Wequal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{W}</span><span class="s1">^T\mathbf</span><span class="si">{x}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f(\mathbf</span><span class="si">{x}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="nd">@Wequal</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>Out[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x15057dc50&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/_documentation_tutorials_Dimension_Reduction_6_1.png" src="../../_images/_documentation_tutorials_Dimension_Reduction_6_1.png" />
</div>
</div>
<p>Clearly, taking an equal contribution of all parameters isn’t effective here. The training samples are rather scattered over the subspace, and we’re unable to fit a ridge approximation <span class="math notranslate nohighlight">\(f(\mathbf{x}) \approx g(\mathbf{W}^T \mathbf{x})\)</span> which effectively describes the variation in <span class="math notranslate nohighlight">\(f(\mathbf{x})\)</span>.</p>
<p>Instead, lets try the obtain a 1D dimension reducing subspace with the <code class="docutils literal notranslate"><span class="pre">Subspaces</span></code> module. We use <code class="docutils literal notranslate"><span class="pre">method='variable-projection'</span></code> here, where the non-linear least squares problem</p>
<div class="math notranslate nohighlight">
\[\underset{\mathbf{W}, \boldsymbol{\alpha}}{\text{minimize}} \; \; \left\Vert f\left(\mathbf{x}\right)-g_{\boldsymbol{\alpha}}\left(\mathbf{W}^{T} \mathbf{x}\right)\right\Vert _{2}^{2}\]</div>
<p>is solved by recasting it as a separable non-linear least squares problem. Here, Gauss-Newton optimization used to solve for the polynomial coefficients <span class="math notranslate nohighlight">\(\alpha\)</span> and subspace matrix <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> together. After computing the <code class="docutils literal notranslate"><span class="pre">Subspace</span></code>, we could generate the below plot in one line using <code class="docutils literal notranslate"><span class="pre">plot_sufficient_summary()</span></code>, but here we’ll do it manually to expose the inner workings.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Apply variable projection</span>
<span class="n">subdim</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">subspace</span> <span class="o">=</span> <span class="n">eq</span><span class="o">.</span><span class="n">Subspaces</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;variable-projection&#39;</span><span class="p">,</span><span class="n">sample_points</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
                            <span class="n">sample_outputs</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">polynomial_degree</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">subspace_dimension</span><span class="o">=</span><span class="n">subdim</span><span class="p">)</span>
<span class="n">Wvp</span> <span class="o">=</span> <span class="n">subspace</span><span class="o">.</span><span class="n">get_subspace</span><span class="p">()[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">subdim</span><span class="p">]</span>
<span class="n">u</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="nd">@Wvp</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">subpoly</span> <span class="o">=</span> <span class="n">subspace</span><span class="o">.</span><span class="n">get_subspace_polynomial</span><span class="p">()</span>

<span class="c1"># Plot the resulting subspace</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathbf</span><span class="si">{W}</span><span class="s1">^T\mathbf</span><span class="si">{x}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f(\mathbf</span><span class="si">{x}</span><span class="s1">)$&#39;</span><span class="p">)</span>
<span class="n">u_vp</span> <span class="o">=</span> <span class="n">X</span><span class="nd">@Wvp</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_vp</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training samples&#39;</span><span class="p">)</span>
<span class="n">u_to_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">u_vp</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="n">u_vp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_to_plot</span><span class="p">,</span><span class="n">subpoly</span><span class="o">.</span><span class="n">get_polyfit</span><span class="p">(</span><span class="n">u_to_plot</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;firebrick&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ridge function&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>Out[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x1539fe3c8&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/_documentation_tutorials_Dimension_Reduction_8_1.png" src="../../_images/_documentation_tutorials_Dimension_Reduction_8_1.png" />
</div>
</div>
<p>Much better! We now have a one-dimensional subspace, formed from a linear combination of the 25 design parameters, which is able to describe the variation in the fan efficiency, <span class="math notranslate nohighlight">\(f=\eta\)</span>. As we will see in later tutorials, such subspaces can be used for design space exploration, physics investigation, and even flowfield estimation!</p>
</div>
</div>
<div class="admonition tutorial">
  This page was generated from
  <a class="reference external" href="https://github.com/equadratures/equadratures.github.io/blob/master/_documentation/tutorials/Dimension_Reduction.ipynb">tutorials/Dimension_Reduction.ipynb</a>.
  <br>
  Interactive online version:
  <span style="white-space: nowrap;"><a href="https://colab.research.google.com/github/equadratures/equadratures.github.io/blob/master/_documentation/tutorials/Dimension_Reduction.ipynb"><img alt="Colab badge" src="https://colab.research.google.com/assets/colab-badge.svg" style="vertical-align:text-bottom"></a></span>
</div>

              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer>
<div align="center"> 
<div class="logos">
<a href="https://github.com/Effective-Quadratures/Effective-Quadratures"><i class="fab fa-github"></i></a>   
<a href="https://effectivequadratures.slack.com/"><i class="fab fa-slack"></i></a>   
<a href="https://twitter.com/EQuadratures"><i class="fab fa-twitter"></i></a>   
<a href="https://discourse.equadratures.org"><i class="fab fa-discourse"></i></a>   
<a href="https://www.linkedin.com/company/effective-quadratures/about/"><i class="fab fa-linkedin"></i></a>   
<a href="https://www.youtube.com/channel/UCpjwFDSZuFbzW-2lj6d96dA"><i class="fab fa-youtube"></i></a>   
</div>

<span>Made by the Effective Quadratures Team, with ❤️</span>    
<span>Copyright © 2016-2021 by equadratures.org</span>    
<span> <a href="mailto:contact@equadratures.org">contact@equadratures.org</a> </span>   
</div>
</footer>
  </body>
</html>